plot(c(1,2,3,4),c(1,2,3,4))
library(devtools)
install.packages("devtools")
library(devtools)
library('devtools')
install.packages("glue")
library('devtools')
install.packages("devtools")
library('devtools')
install_github("roespada/DCAforRpackage",subdir="DCAforR")
library(DCAforR)
msa<-readAlignment(file)
msa
library(DCAforR)
file<-system.file("PF00023_ncbi.txt", package = "DCAforR")
msa<-readAlignment(file)
msa
View(msa)
MSA.n.neighbours(msa=msa, n=1,outfile="PF0023_2reps.txt")
pwd
getwd()
table(ChickWeight$Diet)
table(ChickWeight$Diet,  dnn = "Observations per diet")
with(ChickWeight, table(weight, Diet, dnn = c("cweight", "cDiet")))
nom<-rownames(msa)
nom
nom<-matrix(unlist(sapply(sapply(nom,strsplit,"/"),strsplit,"-")),ncol=3,byrow=T)
f<-table(nom[,1])
f
nom
f
help("seq_along")
n1<-names(which(f>n))
n=1
nom<-rownames(msa)
nom<-matrix(unlist(sapply(sapply(nom,strsplit,"/"),strsplit,"-")),ncol=3,byrow=T)
f<-table(nom[,1])
n1<-names(which(f>n))
n1
enp<-which(nom[,1]==n1[i])  #indices de donde aparece la proteina n1[i]
i=1
enp<-which(nom[,1]==n1[i])  #indices de donde aparece la proteina n1[i]
nom.sub<-nom[enp,]
nom.sub<-nom.sub[order(as.numeric(nom.sub[,2])),]
enp<-which(nom[,1]==n1[i])  #indices de donde aparece la proteina n1[i]
nom.sub<-nom[enp,]
nom.sub
nom.sub<-nom.sub[order(as.numeric(nom.sub[,2])),]
nom.sub
help("next")
file
msa
msa[1,]
msa$390354872/18-46
msa[1]
msa$1
view(msa)
View(msa)
msa<-msa.removed.gaps(msa)
msa<-readAlignment(file)
msa<-msa.removed.gaps(msa)
msa
View(msa)
msa<-readAlignment(file)
length(msa)
nrow(msa)
msa<-msa.removed.gaps(msa)
nrow(msa)
msa<-msa.removed.gaps(msa,cutoff.gaps = 0.7)
nrow(msa)
ncol(msa)
msa<-msa.removed.gaps(msa)
MSA.n.neighbours(msa=msa, n=1,outfile="PF0023_2reps.txt")
msa<-readAlignment("PF0023_2reps.txt")
library(DCAforR)
source('~/Dropbox (Harvard University)/marksLab/repeatsProject/rCode/weight.idREP.R')
# file<-system.file("PF00023_ncbi.txt", package = "DCAforR")
# msa<-readAlignment(file)
# msa<-msa.removed.gaps(msa)
# MSA.n.neighbours(msa=msa, n=1,outfile="PF0023_2reps.txt")
# file2 = system.file('PF0023_2reps.txt',package='DCAforR')
setwd('/Users/adashaw/Dropbox (Harvard University)/marksLab/repeatsProject/rCode/')
file2="PF0023_2reps.txt"
msa<-readAlignment(file2)
msa<-msa.removed.gaps(msa)
msa <-msa2num(msa)
library(DCAforR)
# source('~/Dropbox (Harvard University)/marksLab/repeatsProject/rCode/weight.idREP.R')
# file<-system.file("PF00023_ncbi.txt", package = "DCAforR")
# msa<-readAlignment(file)
# msa<-msa.removed.gaps(msa)
# MSA.n.neighbours(msa=msa, n=1,outfile="PF0023_2reps.txt")
# file2 = system.file('PF0023_2reps.txt',package='DCAforR')
setwd('/Users/adashaw/Dropbox (Harvard University)/marksLab/repeatsProject/rCode/')
file2="PF0023_2reps.txt"
msa<-readAlignment(file2)
msa<-msa.removed.gaps(msa)
msa <-msa2num(msa)
w <- Henikoff.w(msa,fmarg=aa.freqmarg(M=msa))
# png('testphoto_density.png',height=600,width=600)
# wid <-weight.idREP_ada(msa,file2)
# dev.off()
wid <- weight.idREP(msa)
w$w <- w$w*wid
library(DCAforR)
# source('~/Dropbox (Harvard University)/marksLab/repeatsProject/rCode/weight.idREP.R')
# file<-system.file("PF00023_ncbi.txt", package = "DCAforR")
# msa<-readAlignment(file)
# msa<-msa.removed.gaps(msa)
# MSA.n.neighbours(msa=msa, n=1,outfile="PF0023_2reps.txt")
# file2 = system.file('PF0023_2reps.txt',package='DCAforR')
setwd('/Users/adashaw/Dropbox (Harvard University)/marksLab/repeatsProject/rCode/')
file2="PF0023_2reps.txt"
msa<-readAlignment(file2)
msa<-msa.removed.gaps(msa)
msa <-msa2num(msa)
w <- Henikoff.w(msa,fmarg=aa.freq.marg(M=msa))
# png('testphoto_density.png',height=600,width=600)
# wid <-weight.idREP_ada(msa,file2)
# dev.off()
wid <- weight.idREP(msa)
w$w <- w$w*wid
w$w
w
w
clc
clear
w$w
write.table(w$w, file="weights.txt", row.names=FALSE, col.names=FALSE)
write.table(w$w, file="weights.txt", col.names=FALSE)
